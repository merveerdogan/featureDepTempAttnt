# --------------------------------------------------
# LOAD
# --------------------------------------------------
folder <- "/Users/merve/Library/CloudStorage/OneDrive-YaleUniversity/Projects/Studies/featureDepTempAttnt/experiment/1-pilot/1-1pair/data/filtered"
files  <- list.files(folder, pattern="\\.csv$", full.names=TRUE)
df <- purrr::map_df(files, ~ read.csv(.x, stringsAsFactors = FALSE, check.names = FALSE)) %>%
mutate(trial = row_number())
# --------------------------------------------------
# HELPERS
# --------------------------------------------------
extract_hue <- function(hsl_string) {
as.numeric(str_extract(hsl_string, "(?<=hsl\\().+?(?=,)"))
}
parse_json <- function(x) {
if (is.na(x) || x == "") return(NULL)
tryCatch(fromJSON(x), error=function(e) NULL)
}
convert_to_circular <- function(times) {
times <- sort(times)
if (length(times) <= 1) return(numeric(0))
diffs <- diff(times)
# wrap-around
diffs <- c(diffs, times[1] - times[length(times)])
angles <- diffs / sum(diffs) * 360
return(angles)
}
# --------------------------------------------------
# PARSE LOGS
# --------------------------------------------------
parsed <- df %>%
rowwise() %>%
mutate(
sizeEvents = list({
raw <- parse_json(sizeChangeLog)
if (is.null(raw)) return(tibble())
tibble(
size_time  = raw$timeMs,
size_width = map_dbl(raw$rectSize, ~ .x[1]),
size_height= map_dbl(raw$rectSize, ~ .x[2])
)
}),
colorEvents = list({
raw <- parse_json(colorChangeLog)
if (is.null(raw)) return(tibble())
tibble(
color_time = raw$timeMs,
hue        = map_dbl(raw$colorHsl, extract_hue)
)
})
) %>% ungroup()
size_timing_df <- parsed %>% select(trial, attendedFeature, sizeTempo, colorTempo, sizeEvents) %>% unnest(sizeEvents)
color_timing_df <- parsed %>% select(trial, attendedFeature, sizeTempo, colorTempo, colorEvents) %>% unnest(colorEvents)
# --------------------------------------------------
# FIND BIG SIZE EVENTS
# --------------------------------------------------
size_big_timing <- size_timing_df %>%
group_by(trial) %>%
mutate(
size_val = pmax(size_width, size_height),
max_val  = max(size_val),
big      = size_val == max_val
) %>%
filter(big) %>%
select(trial, size_time)
# --------------------------------------------------
# FIND BIG COLOR EVENTS
# --------------------------------------------------
color_big_timing <- color_timing_df %>%
group_by(trial) %>%
mutate(
max_hue = max(hue),
big     = hue == max_hue
) %>%
filter(big) %>%
select(trial, color_time)
# --------------------------------------------------
# MERGE
# --------------------------------------------------
trial_info <- df %>% select(trial, attendedFeature, sizeTempo, colorTempo)
size_big <- size_big_timing %>%
left_join(trial_info, by="trial") %>%
arrange(trial, size_time) %>%
group_by(trial, attendedFeature, sizeTempo, colorTempo) %>%
summarise(big_times = list(size_time), .groups="drop")
color_big <- color_big_timing %>%
left_join(trial_info, by="trial") %>%
arrange(trial, color_time) %>%
group_by(trial, attendedFeature, sizeTempo, colorTempo) %>%
summarise(big_times = list(color_time), .groups="drop")
# --------------------------------------------------
# CIRCULAR CONVERSION
# --------------------------------------------------
size_circular <- size_big %>%
mutate(
tempo_pair = paste0(sizeTempo, "-", colorTempo),
circular_angles = map(big_times, convert_to_circular),
event_type = "Size"
)
color_circular <- color_big %>%
mutate(
tempo_pair = ifelse(attendedFeature=="color",
paste0(colorTempo, "-", sizeTempo),
paste0(sizeTempo, "-", colorTempo)),
circular_angles = map(big_times, convert_to_circular),
event_type = "Color"
)
# --------------------------------------------------
# FINAL TABLE (8 circular distributions)
# --------------------------------------------------
circular_df <- bind_rows(size_circular, color_circular) %>%
unnest(circular_angles) %>%
mutate(
tempo_pair = factor(tempo_pair),
group_name = paste(attendedFeature, event_type, tempo_pair, sep=" - ")
)
# --------------------------------------------------
# PLOT (example rose plot)
# --------------------------------------------------
ggplot(circular_df, aes(x = circular_angles)) +
geom_histogram(binwidth=30, fill="steelblue", alpha=0.7, color="white") +
coord_polar() +
facet_grid(event_type ~ tempo_pair) +
theme_minimal() +
labs(
x = "Angle (degrees)",
y = "Count",
title = "Circular Distributions of Big Events"
)
library(tidyverse)
library(jsonlite)
# --------------------------------------------------
# LOAD
# --------------------------------------------------
folder <- "/Users/merve/Library/CloudStorage/OneDrive-YaleUniversity/Projects/Studies/featureDepTempAttnt/experiment/1-pilot/1-1pair/data/filtered"
files  <- list.files(folder, pattern="\\.csv$", full.names=TRUE)
df <- purrr::map_df(files, ~ read.csv(.x, stringsAsFactors = FALSE, check.names = FALSE)) %>%
mutate(trial = row_number())
# --------------------------------------------------
# HELPERS
# --------------------------------------------------
extract_hue <- function(hsl_string) {
as.numeric(str_extract(hsl_string, "(?<=hsl\\().+?(?=,)"))
}
parse_json <- function(x) {
if (is.na(x) || x == "") return(NULL)
tryCatch(fromJSON(x), error=function(e) NULL)
}
convert_to_circular <- function(times) {
times <- sort(times)
if (length(times) <= 1) return(numeric(0))
diffs <- diff(times)
# wrap-around
diffs <- c(diffs, times[1] - times[length(times)])
angles <- diffs / sum(diffs) * 360
return(angles)
}
# --------------------------------------------------
# PARSE LOGS
# --------------------------------------------------
parsed <- df %>%
rowwise() %>%
mutate(
sizeEvents = list({
raw <- parse_json(sizeChangeLog)
if (is.null(raw)) return(tibble())
tibble(
size_time  = raw$timeMs,
size_width = map_dbl(raw$rectSize, ~ .x[1]),
size_height= map_dbl(raw$rectSize, ~ .x[2])
)
}),
colorEvents = list({
raw <- parse_json(colorChangeLog)
if (is.null(raw)) return(tibble())
tibble(
color_time = raw$timeMs,
hue        = map_dbl(raw$colorHsl, extract_hue)
)
})
) %>% ungroup()
size_timing_df <- parsed %>% select(trial, attendedFeature, sizeTempo, colorTempo, sizeEvents) %>% unnest(sizeEvents)
color_timing_df <- parsed %>% select(trial, attendedFeature, sizeTempo, colorTempo, colorEvents) %>% unnest(colorEvents)
# --------------------------------------------------
# FIND BIG SIZE EVENTS
# --------------------------------------------------
size_big_timing <- size_timing_df %>%
group_by(trial) %>%
mutate(
size_val = pmax(size_width, size_height),
max_val  = max(size_val),
big      = size_val == max_val
) %>%
filter(big) %>%
select(trial, size_time)
# --------------------------------------------------
# FIND BIG COLOR EVENTS
# --------------------------------------------------
color_big_timing <- color_timing_df %>%
group_by(trial) %>%
mutate(
max_hue = max(hue),
big     = hue == max_hue
) %>%
filter(big) %>%
select(trial, color_time)
# --------------------------------------------------
# MERGE
# --------------------------------------------------
trial_info <- df %>% select(trial, attendedFeature, sizeTempo, colorTempo)
size_big <- size_big_timing %>%
left_join(trial_info, by="trial") %>%
arrange(trial, size_time) %>%
group_by(trial, attendedFeature, sizeTempo, colorTempo) %>%
summarise(big_times = list(size_time), .groups="drop")
color_big <- color_big_timing %>%
left_join(trial_info, by="trial") %>%
arrange(trial, color_time) %>%
group_by(trial, attendedFeature, sizeTempo, colorTempo) %>%
summarise(big_times = list(color_time), .groups="drop")
# --------------------------------------------------
# CIRCULAR CONVERSION
# --------------------------------------------------
size_circular <- size_big %>%
mutate(
tempo_pair = paste0(sizeTempo, "-", colorTempo),
circular_angles = map(big_times, convert_to_circular),
event_type = "Size"
)
color_circular <- color_big %>%
mutate(
tempo_pair = ifelse(attendedFeature=="color",
paste0(colorTempo, "-", sizeTempo),
paste0(sizeTempo, "-", colorTempo)),
circular_angles = map(big_times, convert_to_circular),
event_type = "Color"
)
# --------------------------------------------------
# FINAL TABLE (8 circular distributions)
# --------------------------------------------------
circular_df <- bind_rows(size_circular, color_circular) %>%
unnest(circular_angles) %>%
mutate(
tempo_pair = factor(tempo_pair),
group_name = paste(attendedFeature, event_type, tempo_pair, sep=" - ")
)
# --------------------------------------------------
# PLOT (example rose plot)
# --------------------------------------------------
ggplot(circular_df, aes(x = circular_angles)) +
geom_histogram(binwidth=30, fill="steelblue", alpha=0.7, color="white") +
coord_polar() +
facet_grid(event_type ~ tempo_pair) +
theme_minimal() +
labs(
x = "Angle (degrees)",
y = "Count",
title = "Circular Distributions of Big Events"
)
ggplot(circular_df, aes(x = circular_angles)) +
geom_histogram(binwidth=30, fill="steelblue", alpha=0.7, color="white") +
coord_polar() +
facet_grid(event_type ~ tempo_pair) +
theme_minimal() +
labs(
x = "Angle (degrees)",
y = "Count",
title = "Circular Distributions of Big Events"
)
library(tidyverse)
library(jsonlite)
# --------------------------------------------------
# LOAD
# --------------------------------------------------
folder <- "/Users/merve/Library/CloudStorage/OneDrive-YaleUniversity/Projects/Studies/featureDepTempAttnt/experiment/1-pilot/1-1pair/data/filtered"
files  <- list.files(folder, pattern="\\.csv$", full.names=TRUE)
df <- purrr::map_df(files, ~ read.csv(.x, stringsAsFactors = FALSE, check.names = FALSE)) %>%
mutate(trial = row_number())
# --------------------------------------------------
# HELPERS
# --------------------------------------------------
extract_hue <- function(hsl_string) {
as.numeric(str_extract(hsl_string, "(?<=hsl\\().+?(?=,)"))
}
parse_json <- function(x) {
if (is.na(x) || x == "") return(NULL)
tryCatch(fromJSON(x), error=function(e) NULL)
}
convert_to_circular <- function(times) {
times <- sort(times)
if (length(times) <= 1) return(numeric(0))
diffs <- diff(times)
# wrap-around
diffs <- c(diffs, times[1] - times[length(times)])
angles <- diffs / sum(diffs) * 360
return(angles)
}
# --------------------------------------------------
# PARSE LOGS
# --------------------------------------------------
parsed <- df %>%
rowwise() %>%
mutate(
sizeEvents = list({
raw <- parse_json(sizeChangeLog)
if (is.null(raw)) return(tibble())
tibble(
size_time  = raw$timeMs,
size_width = map_dbl(raw$rectSize, ~ .x[1]),
size_height= map_dbl(raw$rectSize, ~ .x[2])
)
}),
colorEvents = list({
raw <- parse_json(colorChangeLog)
if (is.null(raw)) return(tibble())
tibble(
color_time = raw$timeMs,
hue        = map_dbl(raw$colorHsl, extract_hue)
)
})
) %>% ungroup()
size_timing_df <- parsed %>% select(trial, attendedFeature, sizeTempo, colorTempo, sizeEvents) %>% unnest(sizeEvents)
color_timing_df <- parsed %>% select(trial, attendedFeature, sizeTempo, colorTempo, colorEvents) %>% unnest(colorEvents)
# --------------------------------------------------
# FIND BIG SIZE EVENTS
# --------------------------------------------------
size_big_timing <- size_timing_df %>%
group_by(trial) %>%
mutate(
size_val = pmax(size_width, size_height),
max_val  = max(size_val),
big      = size_val == max_val
) %>%
filter(big) %>%
select(trial, size_time)
# --------------------------------------------------
# FIND BIG COLOR EVENTS
# --------------------------------------------------
color_big_timing <- color_timing_df %>%
group_by(trial) %>%
mutate(
max_hue = max(hue),
big     = hue == max_hue
) %>%
filter(big) %>%
select(trial, color_time)
# --------------------------------------------------
# MERGE
# --------------------------------------------------
trial_info <- df %>% select(trial, attendedFeature, sizeTempo, colorTempo)
size_big <- size_big_timing %>%
left_join(trial_info, by="trial") %>%
arrange(trial, size_time) %>%
group_by(trial, attendedFeature, sizeTempo, colorTempo) %>%
summarise(big_times = list(size_time), .groups="drop")
color_big <- color_big_timing %>%
left_join(trial_info, by="trial") %>%
arrange(trial, color_time) %>%
group_by(trial, attendedFeature, sizeTempo, colorTempo) %>%
summarise(big_times = list(color_time), .groups="drop")
# --------------------------------------------------
# CIRCULAR CONVERSION
# --------------------------------------------------
size_circular <- size_big %>%
mutate(
tempo_pair = paste0(sizeTempo, "-", colorTempo),
circular_angles = map(big_times, convert_to_circular),
event_type = "Size"
)
color_circular <- color_big %>%
mutate(
tempo_pair = ifelse(attendedFeature=="color",
paste0(colorTempo, "-", sizeTempo),
paste0(sizeTempo, "-", colorTempo)),
circular_angles = map(big_times, convert_to_circular),
event_type = "Color"
)
# --------------------------------------------------
# FINAL TABLE (8 circular distributions)
# --------------------------------------------------
circular_df <- bind_rows(size_circular, color_circular) %>%
unnest(circular_angles) %>%
mutate(
tempo_pair = factor(tempo_pair),
group_name = paste(attendedFeature, event_type, tempo_pair, sep=" - ")
)
# --------------------------------------------------
# PLOT (example rose plot)
# --------------------------------------------------
ggplot(circular_df, aes(x = circular_angles)) +
geom_histogram(binwidth=30, fill="steelblue", alpha=0.7, color="white") +
coord_polar() +
facet_grid(event_type ~ tempo_pair) +
theme_minimal() +
labs(
x = "Angle (degrees)",
y = "Count",
title = "Circular Distributions of Big Events"
)
library(tidyverse)
library(jsonlite)
# --------------------------------------------------
# LOAD
# --------------------------------------------------
folder <- "/Users/merve/Library/CloudStorage/OneDrive-YaleUniversity/Projects/Studies/featureDepTempAttnt/experiment/1-pilot/1-1pair/data/filtered"
files  <- list.files(folder, pattern="\\.csv$", full.names=TRUE)
df <- purrr::map_df(files, ~ read.csv(.x, stringsAsFactors=FALSE, check.names=FALSE)) %>%
mutate(trial = row_number())
# --------------------------------------------------
# HELPERS
# --------------------------------------------------
parse_json <- function(x) {
if (is.na(x) || x == "") return(NULL)
tryCatch(fromJSON(x), error=function(e) NULL)
}
extract_hue <- function(hsl_string) {
as.numeric(str_extract(hsl_string, "(?<=hsl\\().+?(?=,)"))
}
convert_to_circular <- function(times) {
times <- sort(times)
n <- length(times)
if (n <= 1) return(numeric(0))
diffs <- diff(times)
wrap  <- times[1] + (max(times) - times[n])
diffs <- c(diffs, wrap)
angles <- diffs / sum(diffs) * 360
angles
}
# --------------------------------------------------
# PARSE LOGS
# --------------------------------------------------
parsed <- df %>%
rowwise() %>%
mutate(
sizeEvents = list({
raw <- parse_json(sizeChangeLog)
if (is.null(raw)) return(NULL)
tibble(
size_time  = raw$timeMs,
size_width = map_dbl(raw$rectSize, 1),
size_height = map_dbl(raw$rectSize, 2)
)
}),
colorEvents = list({
raw <- parse_json(colorChangeLog)
if (is.null(raw)) return(NULL)
tibble(
color_time = raw$timeMs,
hue = map_dbl(raw$colorHsl, extract_hue)
)
})
) %>%
ungroup()
size_timing_df <- parsed %>% select(trial, attendedFeature, sizeTempo, colorTempo, sizeEvents) %>% unnest(sizeEvents)
color_timing_df <- parsed %>% select(trial, attendedFeature, sizeTempo, colorTempo, colorEvents) %>% unnest(colorEvents)
# --------------------------------------------------
# BIG SIZE EVENTS
# --------------------------------------------------
size_big <- size_timing_df %>%
group_by(trial) %>%
filter(pmax(size_width, size_height) == max(pmax(size_width, size_height))) %>%
select(trial, size_time) %>%
left_join(df %>% select(trial, attendedFeature, sizeTempo, colorTempo), by="trial") %>%
arrange(trial, size_time) %>%
group_by(trial, attendedFeature, sizeTempo, colorTempo) %>%
summarise(big_times = list(size_time), .groups="drop")
# --------------------------------------------------
# BIG COLOR EVENTS
# --------------------------------------------------
color_big <- color_timing_df %>%
group_by(trial) %>%
filter(hue == max(hue)) %>%
select(trial, color_time) %>%
left_join(df %>% select(trial, attendedFeature, sizeTempo, colorTempo), by="trial") %>%
arrange(trial, color_time) %>%
group_by(trial, attendedFeature, sizeTempo, colorTempo) %>%
summarise(big_times = list(color_time), .groups="drop")
# --------------------------------------------------
# CIRCULAR
# --------------------------------------------------
size_circ <- size_big %>%
mutate(
tempo_pair = paste0(sizeTempo, "-", colorTempo),
circular_angles = map(big_times, convert_to_circular),
event_type = "Size"
)
color_circ <- color_big %>%
mutate(
tempo_pair = ifelse(attendedFeature=="color",
paste0(colorTempo, "-", sizeTempo),
paste0(sizeTempo, "-", colorTempo)),
circular_angles = map(big_times, convert_to_circular),
event_type = "Color"
)
# --------------------------------------------------
# FINAL TABLE OF 8 (GUARANTEED SMALL)
# --------------------------------------------------
circular_df <- bind_rows(size_circ, color_circ) %>%
unnest(circular_angles) %>%
mutate(
group = paste(attendedFeature, event_type, tempo_pair, sep=" â€¢ ")
)
# --------------------------------------------------
# PLOT (works instantly)
# --------------------------------------------------
ggplot(circular_df, aes(x = circular_angles)) +
geom_histogram(binwidth=30, fill="steelblue", color="white") +
coord_polar() +
facet_grid(event_type ~ tempo_pair) +
theme_minimal() +
labs(x="", y="", title="Circular Distributions of Big Events")
vfdlkmvlkwdsc
fmnrslkdmc
