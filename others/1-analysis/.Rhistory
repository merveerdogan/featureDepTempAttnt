scale_fill_manual(values = c("size_key_angles"="steelblue",
"color_key_angles"="firebrick")) +
scale_x_continuous(breaks=c(0,90,180,270),
labels=c("0°","90°","180°","270°"),
limits=c(0,360)) +
theme_minimal() +
facet_grid(attendedFeature ~ tempo_pair)
})
###TAB 4 ###
output$moving_window_plot <- renderPlot({
win_start <- input$win_start
win_end   <- input$win_start + input$win_size - 1
dat <- circular_long %>%
group_by(participantID, trial, attendedFeature, tempo_pair) %>%
arrange(key_time) %>%                          # order by time
mutate(key_index = row_number()) %>%          # index keypress events
filter(key_index >= win_start,
key_index <= win_end)
ggplot(dat, aes(x = angles, fill = angle_type)) +
geom_histogram(binwidth = 10, alpha = 0.7, position="identity") +
coord_polar(start = -pi/2, direction = 1) +
scale_fill_manual(values = c("size_key_angles"="steelblue",
"color_key_angles"="firebrick")) +
scale_x_continuous(breaks=c(0,90,180,270),
labels=c("0°","90°","180°","270°"),
limits=c(0,360)) +
theme_minimal() +
facet_grid(attendedFeature ~ tempo_pair)
})
}
shinyApp(ui, server)
output$avg_plot <- renderPlot({
ggplot(circular_long, aes(x = angles, fill = angle_type)) +
geom_histogram(binwidth = 10, alpha = 0.7, position="identity") +
coord_polar(start=-pi/2, direction=1) +
scale_fill_manual(
name = "Key time as a reference to",
values = c("size_key_angles" = "steelblue",
"color_key_angles" = "firebrick"),
labels = c("size_key_angles" = "Size",
"color_key_angles" = "Color")
) +
scale_x_continuous(
breaks = c(0,90,180,270),
labels = c("0°","90°","180°","270°"),
limits = c(0,360)
) +
theme_minimal() +
facet_grid(
attendedFeature ~ tempo_pair,
labeller = labeller(
tempo_pair = function(x) {
paste0("target ", sub("-.*","",x),
"  -  distractor ", sub(".*-","",x))
}
)
) +
theme(
strip.text = element_text(size = 12),
axis.title = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()
) +
ggtitle(paste0("N=", N)) +
theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 18))
})
e
server <- function(input, output, session){
output$raw_dist <- renderPlot({
N=length(unique(dat$participantID))
ggplot(circular_long, aes(x = key_time, fill = attendedFeature)) +
geom_dotplot() +
scale_fill_manual(values = c("color"="firebrick","size"="steelblue")) +
theme_minimal() +
facet_grid(
attendedFeature ~ tempo_pair,
labeller = labeller(
tempo_pair = function(x) {
paste0("target ", sub("-.*","",x),
"  -  distractor ", sub(".*-","",x),"")
}
)
) +
theme(strip.text = element_text(size=12))+
ggtitle(paste0("N=", N)) +
theme(plot.title = element_text(hjust = 0.5, face = "bold",size = 18))
})
output$avg_plot <- renderPlot({
ggplot(circular_long, aes(x = angles, fill = angle_type)) +
geom_histogram(binwidth = 10, alpha = 0.7, position="identity") +
coord_polar(start=-pi/2, direction=1) +
scale_fill_manual(
name = "Key time as a reference to",
values = c("size_key_angles" = "steelblue",
"color_key_angles" = "firebrick"),
labels = c("size_key_angles" = "Size",
"color_key_angles" = "Color")
) +
scale_x_continuous(
breaks = c(0,90,180,270),
labels = c("0°","90°","180°","270°"),
limits = c(0,360)
) +
theme_minimal() +
facet_grid(
attendedFeature ~ tempo_pair,
labeller = labeller(
tempo_pair = function(x) {
paste0("target ", sub("-.*","",x),
"  -  distractor ", sub(".*-","",x))
}
)
) +
theme(
strip.text = element_text(size = 12),
axis.title = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()
) +
ggtitle(paste0("N=", N)) +
theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 18))
})
output$trial_plot <- renderPlot({
dat <- circular_long %>%
arrange(participantID) %>%
mutate(participant_num = as.integer(factor(participantID))) %>%
group_by(participant_num, attendedFeature, tempo_pair) %>%
summarise(
trials_sorted = sort(unique(trial)),
.groups = "drop"
) %>%
group_by(participant_num, attendedFeature, tempo_pair) %>%
mutate(cond_trial_index = row_number()) %>%
filter(cond_trial_index == input$trial_idx) %>%
inner_join(
circular_long %>%
mutate(participant_num = as.integer(factor(participantID))),
by = c(
"participant_num",
"attendedFeature",
"tempo_pair",
"trials_sorted" = "trial"
)
)
ggplot(circular_long, aes(x = angles, fill = angle_type)) +
geom_histogram(binwidth = 10, alpha = 0.7, position = "identity") +
coord_polar(start = -pi/2, direction = 1) +
scale_fill_manual(
name = "Key time as a reference to",
values = c("size_key_angles" = "steelblue",
"color_key_angles" = "firebrick"),
labels = c("size_key_angles" = "Size",
"color_key_angles" = "Color")
) +
scale_x_continuous(
breaks = c(0,90,180,270),
labels = c("0°","90°","180°","270°"),
limits = c(0,360)
) +
theme_minimal() +
facet_grid(
attendedFeature ~ tempo_pair,
labeller = labeller(
tempo_pair = function(x) {
paste0("target ", sub("-.*","",x),
"  -  distractor ", sub(".*-","",x))
}
)
) +
theme(
strip.text = element_text(size = 12),
axis.title = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()
) +
ggtitle(paste0("N=", N)) +
theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 18))
})
### TAB 3 ###
output$angle_plot <- renderPlot({
dat <- circular_long %>%
group_by(participantID,trial, attendedFeature, tempo_pair) %>%
arrange(angles) %>%
mutate(angle_index = row_number()) %>%
filter(angle_index >= input$angle_range[1],
angle_index <= input$angle_range[2])
ggplot(dat, aes(x = angles, fill = angle_type)) +
geom_histogram(binwidth = 10, alpha = 0.7, position="identity") +
coord_polar(start = -pi/2, direction = 1) +
scale_fill_manual(
name = "Key time as a reference to",
values = c("size_key_angles" = "steelblue",
"color_key_angles" = "firebrick"),
labels = c("size_key_angles" = "Size",
"color_key_angles" = "Color")
) +
scale_x_continuous(
breaks = c(0,90,180,270),
labels = c("0°","90°","180°","270°"),
limits = c(0,360)
) +
theme_minimal() +
facet_grid(
attendedFeature ~ tempo_pair,
labeller = labeller(
tempo_pair = function(x) {
paste0("target ", sub("-.*","",x),
"  -  distractor ", sub(".*-","",x))
}
)
) +
theme(
strip.text = element_text(size = 12),
axis.title = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()
) +
ggtitle(paste0("N=", N)) +
theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 18))
})
###TAB 4 ###
output$moving_window_plot <- renderPlot({
win_start <- input$win_start
win_end   <- input$win_start + input$win_size - 1
dat <- circular_long %>%
group_by(participantID, trial, attendedFeature, tempo_pair) %>%
arrange(key_time) %>%                          # order by time
mutate(key_index = row_number()) %>%          # index keypress events
filter(key_index >= win_start,
key_index <= win_end)
ggplot(dat, aes(x = angles, fill = angle_type)) +
geom_histogram(binwidth = 10, alpha = 0.7, position="identity") +
coord_polar(start = -pi/2, direction = 1) +
scale_fill_manual(
name = "Key time as a reference to",
values = c("size_key_angles" = "steelblue",
"color_key_angles" = "firebrick"),
labels = c("size_key_angles" = "Size",
"color_key_angles" = "Color")
) +
scale_x_continuous(
breaks = c(0,90,180,270),
labels = c("0°","90°","180°","270°"),
limits = c(0,360)
) +
theme_minimal() +
facet_grid(
attendedFeature ~ tempo_pair,
labeller = labeller(
tempo_pair = function(x) {
paste0("target ", sub("-.*","",x),
"  -  distractor ", sub(".*-","",x))
}
)
) +
theme(
strip.text = element_text(size = 12),
axis.title = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()
) +
ggtitle(paste0("N=", N)) +
theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 18))
})
}
shinyApp(ui, server)
### INTERACTIVE PLOTS ###
ui <- fluidPage(
tabsetPanel(
tabPanel("Raw Distribution",
plotOutput("raw_dist")
),
tabPanel("All trials",
plotOutput("avg_plot")
),
tabPanel("Trial-byTrial",
sliderInput("trial_idx","Trial index", min=1,  max = unique(conditions$total_trials), value = 1,step = 1),
plotOutput("trial_plot")
),
tabPanel("Time Window Within Trial",
sliderInput("angle_range",
"Keypress Event Range",
min = 1,
max = 100,
value = c(1,5),
step = 1),
plotOutput("angle_plot")
),
tabPanel("Time Window Within Trial - v2",
fluidRow(
column(
width = 6,
div(style="padding-right:20px;",
sliderInput("win_size",
"Window size (keypress events):",
min = 1, max = 50,
value = 20, step = 1)
)
),
column(
width = 6,
div(style="padding-left:20px;",
sliderInput("win_start",
"Window start index:",
min = 1, max = 80,
value = 1, step = 1)
)
)
),
plotOutput("moving_window_plot")
)
)
)
server <- function(input, output, session){
output$raw_dist <- renderPlot({
N=length(unique(dat$participantID))
ggplot(circular_long, aes(x = key_time, fill = attendedFeature)) +
geom_dotplot() +
scale_fill_manual(values = c("color"="firebrick","size"="steelblue")) +
theme_minimal() +
facet_grid(
attendedFeature ~ tempo_pair,
labeller = labeller(
tempo_pair = function(x) {
paste0("target ", sub("-.*","",x),
"  -  distractor ", sub(".*-","",x),"")
}
)
) +
theme(strip.text = element_text(size=12))+
ggtitle(paste0("N=", N)) +
theme(plot.title = element_text(hjust = 0.5, face = "bold",size = 18))
})
output$avg_plot <- renderPlot({
ggplot(circular_long, aes(x = angles, fill = angle_type)) +
geom_histogram(binwidth = 10, alpha = 0.7, position="identity") +
coord_polar(start=-pi/2, direction=1) +
scale_fill_manual(
name = "Key time as a reference to",
values = c("size_key_angles" = "steelblue",
"color_key_angles" = "firebrick"),
labels = c("size_key_angles" = "Size",
"color_key_angles" = "Color")
) +
scale_x_continuous(
breaks = c(0,90,180,270),
labels = c("0°","90°","180°","270°"),
limits = c(0,360)
) +
theme_minimal() +
facet_grid(
attendedFeature ~ tempo_pair,
labeller = labeller(
tempo_pair = function(x) {
paste0("target ", sub("-.*","",x),
"  -  distractor ", sub(".*-","",x))
}
)
) +
theme(
strip.text = element_text(size = 12),
axis.title = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()
) +
ggtitle(paste0("N=", N)) +
theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 18))
})
output$trial_plot <- renderPlot({
dat <- circular_long %>%
arrange(participantID) %>%
mutate(participant_num = as.integer(factor(participantID))) %>%
group_by(participant_num, attendedFeature, tempo_pair) %>%
summarise(
trials_sorted = sort(unique(trial)),
.groups = "drop"
) %>%
group_by(participant_num, attendedFeature, tempo_pair) %>%
mutate(cond_trial_index = row_number()) %>%
filter(cond_trial_index == input$trial_idx) %>%
inner_join(
circular_long %>%
mutate(participant_num = as.integer(factor(participantID))),
by = c(
"participant_num",
"attendedFeature",
"tempo_pair",
"trials_sorted" = "trial"
)
)
ggplot(circular_long, aes(x = angles, fill = angle_type)) +
geom_histogram(binwidth = 10, alpha = 0.7, position = "identity") +
coord_polar(start = -pi/2, direction = 1) +
scale_fill_manual(
name = "Key time as a reference to",
values = c("size_key_angles" = "steelblue",
"color_key_angles" = "firebrick"),
labels = c("size_key_angles" = "Size",
"color_key_angles" = "Color")
) +
scale_x_continuous(
breaks = c(0,90,180,270),
labels = c("0°","90°","180°","270°"),
limits = c(0,360)
) +
theme_minimal() +
facet_grid(
attendedFeature ~ tempo_pair,
labeller = labeller(
tempo_pair = function(x) {
paste0("target ", sub("-.*","",x),
"  -  distractor ", sub(".*-","",x))
}
)
) +
theme(
strip.text = element_text(size = 12),
axis.title = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()
) +
ggtitle(paste0("N=", N)) +
theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 18))
})
### TAB 3 ###
output$angle_plot <- renderPlot({
dat <- circular_long %>%
group_by(participantID,trial, attendedFeature, tempo_pair) %>%
arrange(angles) %>%
mutate(angle_index = row_number()) %>%
filter(angle_index >= input$angle_range[1],
angle_index <= input$angle_range[2])
ggplot(dat, aes(x = angles, fill = angle_type)) +
geom_histogram(binwidth = 10, alpha = 0.7, position="identity") +
coord_polar(start = -pi/2, direction = 1) +
scale_fill_manual(
name = "Key time as a reference to",
values = c("size_key_angles" = "steelblue",
"color_key_angles" = "firebrick"),
labels = c("size_key_angles" = "Size",
"color_key_angles" = "Color")
) +
scale_x_continuous(
breaks = c(0,90,180,270),
labels = c("0°","90°","180°","270°"),
limits = c(0,360)
) +
theme_minimal() +
facet_grid(
attendedFeature ~ tempo_pair,
labeller = labeller(
tempo_pair = function(x) {
paste0("target ", sub("-.*","",x),
"  -  distractor ", sub(".*-","",x))
}
)
) +
theme(
strip.text = element_text(size = 12),
axis.title = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()
) +
ggtitle(paste0("N=", N)) +
theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 18))
})
###TAB 4 ###
output$moving_window_plot <- renderPlot({
win_start <- input$win_start
win_end   <- input$win_start + input$win_size - 1
dat <- circular_long %>%
group_by(participantID, trial, attendedFeature, tempo_pair) %>%
arrange(key_time) %>%                          # order by time
mutate(key_index = row_number()) %>%          # index keypress events
filter(key_index >= win_start,
key_index <= win_end)
ggplot(dat, aes(x = angles, fill = angle_type)) +
geom_histogram(binwidth = 10, alpha = 0.7, position="identity") +
coord_polar(start = -pi/2, direction = 1) +
scale_fill_manual(
name = "Key time as a reference to",
values = c("size_key_angles" = "steelblue",
"color_key_angles" = "firebrick"),
labels = c("size_key_angles" = "Size",
"color_key_angles" = "Color")
) +
scale_x_continuous(
breaks = c(0,90,180,270),
labels = c("0°","90°","180°","270°"),
limits = c(0,360)
) +
theme_minimal() +
facet_grid(
attendedFeature ~ tempo_pair,
labeller = labeller(
tempo_pair = function(x) {
paste0("target ", sub("-.*","",x),
"  -  distractor ", sub(".*-","",x))
}
)
) +
theme(
strip.text = element_text(size = 12),
axis.title = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()
) +
ggtitle(paste0("N=", N)) +
theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 18))
})
}
shinyApp(ui, server)
